{% extends 'myapp/base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}Perfil de {{ user.username }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/ver_perfil.css' %}">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@icon/entypo@1.0.3/entypo.css" rel="stylesheet">
<style>
    .btn-group-custom {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    .btn-custom {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .btn-custom i {
        font-size: 1.2em;
    }

    .left-profile-card .user-profile img {
        width: 100%;
        max-width: 150px;
        height: auto;
        margin: 0 auto;
        display: block;
        border-radius: 50%;
    }

    .timeline-entry-inner {
        margin-bottom: 20px;
    }

    .card-body h3 {
        font-size: 1.5em;
        margin-bottom: 20px;
        font-weight: bold;
    }

    .personal-info ul {
        list-style: none;
        padding: 0;
    }

    .personal-info ul li {
        margin-bottom: 10px;
    }

    .personal-info ul li i {
        margin-right: 10px;
    }

    .availability-form {
        margin-top: 20px;
        text-align: center;
    }

    .availability-form button {
        margin-top: 10px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container bootstrap snippet mt-5">
    <div class="row">
        <div class="col-md-12">
            <div class="btn-group-custom">
                <a href="{% url 'editar_perfil' %}" class="btn btn-primary btn-custom">
                    <i class="fa fa-edit"></i> Editar Perfil
                </a>
                <a href="{% url 'cambiar_password' %}" class="btn btn-secondary btn-custom">
                    <i class="fa fa-key"></i> Cambiar Contraseña
                </a>
                <a href="{% url 'historial_actividades' %}" class="btn btn-info btn-custom">
                    <i class="fa fa-history"></i> Historial de Actividades
                </a>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="left-profile-card card">
                <div class="card-body">
                    <div class="user-profile">
                        {% if perfil.avatar %}
                            <img src="{{ perfil.avatar.url }}" class="img-fluid rounded-circle" alt="Avatar">
                        {% else %}
                            <img src="{% static 'images/default-avatar.png' %}" class="img-fluid rounded-circle" alt="Avatar">
                        {% endif %}
                    </div>
                    <h3>@{{ user.username }}</h3>
                    <div class="availability-form">
                        <h4>Disponibilidad</h4>
                        <form method="post" action="">
                            {% csrf_token %}
                            <button type="submit" name="toggle_disponibilidad" class="btn btn-secondary">
                                {% if perfil.disponibilidad %}
                                    Marcar como No Disponible
                                {% else %}
                                    Marcar como Disponible
                                {% endif %}
                            </button>
                            <p>{{ perfil.disponibilidad|yesno:"Disponible,No disponible" }}</p>
                        </form>
                    </div>
                    <div class="personal-info mt-4">
                        <h3>Información Personal</h3>
                        <ul class="personal-list">
                            <li><i class="entypo-phone"></i>(+56) {{ perfil.telefono }}</li>
                            <li><i class="entypo-calendar"></i>{{ perfil.fecha_nacimiento }}</li>
                            <li><i class="entypo-globe"></i>{{ perfil.website }}</li>
                            <li><i class="fab fa-twitter"></i> {{ perfil.twitter }}</li>
                            <li><i class="fab fa-facebook-f"></i> {{ perfil.facebook }}</li>
                            <li><i class="fab fa-linkedin-in"></i> {{ perfil.linkedin }}</li>
                        </ul>
                    </div>
                    <div class="personal-info mt-4">
                        <h3>Habilidades</h3>
                        <p>{{ perfil.habilidades }}</p>
                    </div>
                    <div class="personal-info mt-4">
                        <h3>Experiencia</h3>
                        <p>{{ perfil.experiencia }}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="right-profile-card card">
                <div class="card-body">
                    <h3>Experiencia Laboral</h3>
                    <div class="timeline-centered">
                        {% for experiencia in experiencias %}
                            <article class="timeline-entry">
                                <div class="timeline-entry-inner">
                                    <div class="timeline-icon bg-success">
                                        <i class="entypo-suitcase"></i>
                                    </div>
                                    <div class="timeline-label">
                                        <h2>{{ experiencia.titulo }}</h2>
                                        <p>{{ experiencia.descripcion }}</p>
                                    </div>
                                    <time class="timeline-time" datetime="{{ experiencia.fecha_inicio }}">{{ experiencia.fecha_inicio|date:"d-m-Y" }} - 
                                        {% if experiencia.fecha_fin %}
                                            {{ experiencia.fecha_fin|date:"d-m-Y" }}
                                        {% else %}
                                            Actualmente
                                        {% endif %}
                                    </time>
                                </div>
                            </article>
                        {% endfor %}
                    </div>
                    <h3>Educación</h3>
                    <div class="timeline-centered">
                        {% for educacion in educaciones %}
                            <article class="timeline-entry">
                                <div class="timeline-entry-inner">
                                    <div class="timeline-icon bg-info">
                                        <i class="entypo-graduation-cap"></i>
                                    </div>
                                    <div class="timeline-label">
                                        <h2>{{ educacion.institucion }}</h2>
                                        <p>{{ educacion.descripcion }}</p>
                                    </div>
                                    <time class="timeline-time" datetime="{{ educacion.fecha_inicio }}">{{ educacion.fecha_inicio|date:"d-m-Y" }} - 
                                        {% if educacion.fecha_fin %}
                                            {{ educacion.fecha_fin|date:"d-m-Y" }}
                                        {% else %}
                                            Actualmente
                                        {% endif %}
                                    </time>
                                </div>
                            </article>
                        {% endfor %}
                    </div>
                    <h3>Proyectos Actuales</h3>
                    <div class="timeline-centered">
                        <h4>Proyectos Creados</h4>
                        {% for proyecto in proyectos_creados %}
                            <article class="timeline-entry">
                                <div class="timeline-entry-inner">
                                    <div class="timeline-icon bg-warning">
                                        <i class="entypo-folder"></i>
                                    </div>
                                    <div class="timeline-label">
                                        <h2>{{ proyecto.nombre }}</h2>
                                        <p>{{ proyecto.descripcion }}</p>
                                    </div>
                                    <time class="timeline-time" datetime="{{ proyecto.fecha_inicio }}">{{ proyecto.fecha_inicio|date:"d-m-Y" }} - 
                                        {% if proyecto.fecha_fin %}
                                            {{ proyecto.fecha_fin|date:"d-m-Y" }}
                                        {% else %}
                                            Actualmente
                                        {% endif %}
                                    </time>
                                </div>
                            </article>
                        {% endfor %}
                        <h4>Proyectos Colaborados</h4>
                        {% for proyecto in proyectos_colaborados %}
                            <article class="timeline-entry">
                                <div class="timeline-entry-inner">
                                    <div class="timeline-icon bg-warning">
                                        <i class="entypo-folder"></i>
                                    </div>
                                    <div class="timeline-label">
                                        <h2>{{ proyecto.nombre }}</h2>
                                        <p>{{ proyecto.descripcion }}</p>
                                    </div>
                                    <time class="timeline-time" datetime="{{ proyecto.fecha_inicio }}">{{ proyecto.fecha_inicio|date:"d-m-Y" }} - 
                                        {% if proyecto.fecha_fin %}
                                            {{ proyecto.fecha_fin|date:"d-m-Y" }}
                                        {% else %}
                                            Actualmente
                                        {% endif %}
                                    </time>
                                </div>
                            </article>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
