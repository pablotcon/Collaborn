{% extends 'myapp/base.html' %}

{% load static %}

{% block title %}Editar Perfil{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/editar_perfil.css' %}">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/@icon/entypo@1.0.3/entypo.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="card mb-3">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="card-title">Editar Perfil</h2>
                <a href="{% url 'ver_perfil' %}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left"></i> Volver al perfil
                </a>
            </div>
            <hr>
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-group">
                    <label for="id_nombre">Nombre</label>
                    {{ perfil_form.nombre|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_apellido">Apellido</label>
                    {{ perfil_form.apellido|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_telefono">Teléfono</label>
                    {{ perfil_form.telefono|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_birth_date">Fecha de Nacimiento</label>
                    {{ perfil_form.birth_date|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_website">Sitio Web</label>
                    {{ perfil_form.website|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_twitter">Twitter</label>
                    {{ perfil_form.twitter|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_facebook">Facebook</label>
                    {{ perfil_form.facebook|add_class:"form-control" }}
                </div>
                <div class="form-group">
                    <label for="id_linkedin">LinkedIn</label>
                    {{ perfil_form.linkedin|add_class:"form-control" }}
                </div>
                <hr>
                <h3 class="mb-3">Experiencia Laboral</h3>
                {{ experiencia_formset.management_form }}
                <div id="experiencias">
                    {% for form in experiencia_formset %}
                    <div class="formset border rounded p-3 mb-3">
                        <div class="form-group">
                            <label for="{{ form.titulo.id_for_label }}">Título</label>
                            {{ form.titulo|add_class:"form-control" }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.descripcion.id_for_label }}">Descripción</label>
                            {{ form.descripcion|add_class:"form-control" }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.fecha_inicio.id_for_label }}">Fecha de Inicio</label>
                            {{ form.fecha_inicio|add_class:"form-control" }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.fecha_fin.id_for_label }}">Fecha de Fin</label>
                            {{ form.fecha_fin|add_class:"form-control" }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <button type="button" class="btn btn-outline-primary btn-add mb-3" id="add-experiencia">
                    <i class="fa fa-plus"></i> Agregar Experiencia
                </button>
                <hr>
                <h3 class="mb-3">Educación</h3>
                {{ educacion_formset.management_form }}
                <div id="educaciones">
                    {% for form in educacion_formset %}
                    <div class="formset border rounded p-3 mb-3">
                        <div class="form-group">
                            <label for="{{ form.institucion.id_for_label }}">Institución</label>
                            {{ form.institucion|add_class:"form-control" }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.descripcion.id_for_label }}">Descripción</label>
                            {{ form.descripcion|add_class:"form-control" }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.fecha_inicio.id_for_label }}">Fecha de Inicio</label>
                            {{ form.fecha_inicio|add_class:"form-control" }}
                        </div>
                        <div class="form-group">
                            <label for="{{ form.fecha_fin.id_for_label }}">Fecha de Fin</label>
                            {{ form.fecha_fin|add_class:"form-control" }}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <button type="button" class="btn btn-outline-primary btn-add mb-3" id="add-educacion">
                    <i class="fa fa-plus"></i> Agregar Educación
                </button>
                <hr>
                <button type="submit" class="btn btn-success btn-block">Guardar Cambios</button>
            </form>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    $(document).ready(function() {
        $('#add-experiencia').click(function() {
            var form_idx = $('#id_experiencias-TOTAL_FORMS').val();
            $('#experiencias').append($('#empty_form_experiencia').html().replace(/__prefix__/g, form_idx));
            $('#id_experiencias-TOTAL_FORMS').val(parseInt(form_idx) + 1);
        });
        $('#add-educacion').click(function() {
            var form_idx = $('#id_educaciones-TOTAL_FORMS').val();
            $('#educaciones').append($('#empty_form_educacion').html().replace(/__prefix__/g, form_idx));
            $('#id_educaciones-TOTAL_FORMS').val(parseInt(form_idx) + 1);
        });
    });
</script>
{% include 'myapp/empty_form_experiencia.html' %}
{% include 'myapp/empty_form_educacion.html' %}
{% endblock %}
